/* SalesWings v1.0.14
 * Build time: 02-07-2022 07:57:02
 */
"use strict";var ConsoleLogging=function(){function t(){}return t.prototype.debug=function(t){console.debug(t)},t.prototype.error=function(t){console.error(t)},t}(),SilentLogging=function(){function t(){}return t.prototype.debug=function(t){},t.prototype.error=function(t){},t}(),ICommand=function(){function t(t){this.context=t}return t.prototype.send=function(n,o){0==this.context.accounts.length&&this.context.logging.error("Accounts hasn't been initialised"),this.context.uid?this.context.accounts.forEach(function(t){var e=n(t);t.transport.send(t,e.key,e.event,o)}):this.context.logging.error("Wrong configuration, uid is empty")},t.prototype.error=function(t){this.context.logging.error(t)},t.prototype.debug=function(t){this.context.logging.debug(t)},t.prototype.debug1=function(t,e){this.context.logging.debug(t+JSON.stringify(e))},t.prototype.getTime=function(){return(new Date).getTime()},t.prototype.url=function(){return this.context.document.URL},t}(),CookieStorage=function(){function t(t,e,n){this.config=t,this.window=e,this.document=n,this.fd="com|edu|int|org|co".split("|")}return t.prototype.getDomain=function(){var t,e,n=this.config.cookieDomain;return n||(e=(t=window.location.host.replace(/^www\./,"").split(".")).length-2,n=t.slice(0).slice(-(t[e]&&-1!==this.fd.indexOf(t[e])?3:2)).join(".")),n},t.prototype.create=function(t){var e=[this.config.cookieName+"="+encodeURIComponent(t)];e.push("expires="+new Date((new Date).getTime()+this.config.cookieExpires).toUTCString()),this.config.cookieName&&e.push("domain="+this.getDomain()),e.push("path="+this.config.cookiePath);try{this.document.cookie=e.join(";")}catch(t){}},t.prototype.read=function(t){void 0===t&&(t=void 0);var e=this.document.cookie,n=t||this.config.cookieName;return e&&e.match(new RegExp("(?:^|[^;]\s*)"+n+"=([^;]*)"))?decodeURIComponent(RegExp.$1):void 0},t}(),__extends=this&&this.__extends||function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),CustomEventCommand=function(n){function t(t){var e=n.call(this,t)||this;return e.context=t,e}return __extends(t,n),t.prototype.execute=function(e){var n=this;this.send(function(t){return{key:"custom-event",event:{p:t.pid,u:n.context.uid,t:n.getTime(),url:n.url(),kind:e.kind,data:e.data,values:e.values}}})},t}(ICommand),__values=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,i,r=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(o=r.next()).done;)s.push(o.value)}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return s},InitCommand=function(n){function s(t){var e=n.call(this,t)||this;return e.storage=e.context.storage,e}return __extends(s,n),s.prototype.execute=function(t){this.context.storage=this.storage;var e,n,o,i={apiUrl:t.apiUrl||this.context.apiUrl,pid:t.pid};switch(t.debug&&(this.context.logging=new ConsoleLogging),t.cookieName&&(this.context.cookieConfig.cookieName=t.cookieName),t.cookieDomain&&(this.context.cookieConfig.cookieDomain=t.cookieDomain),t.cookiePath&&(this.context.cookieConfig.cookiePath=t.cookiePath),t.cookieExpires&&(this.context.cookieConfig.cookieExpires=t.cookieExpires),this.debug("Initializing SalesWings tracking"),i.pid=t.pid,t.transport){case"get":i.transport=new GetTransport(this.context);break;case"logging":i.transport=new LoggingTransport(this.context);break;case"post":i.transport=new PostTransport(this.context);break;case"beacon":var r="navigator"in window&&"sendBeacon"in window.navigator;i.transport=new(r?BeaconTransport:PostTransport)(this.context);break;default:i.transport=new PostTransport(this.context)}0==this.context.accounts.length&&(e=s.isStandalone(t),n=s.isHost(t),o=s.isGuest(t),this.debug("Mode S/H/G: "+e+"/"+n+"/"+o),(e||n)&&this.processCookie(t),n?this.processHost(t.binding):o&&this.processGuest(t.binding)),this.context.accounts.push(i)},s.prototype.processGuest=function(o){var i=this,r=this.context.window;r.addEventListener("message",function(t){var e,n=t.origin.split("//").pop()||"NA";-1!==(o.trustedDomains||[]).indexOf(n)?(e=t.data.rid,i.context.uid=t.data.uid,i.storage.create(t.data.uid),i.debug1("Received message (guest): ",t.data),r.parent.postMessage({rid:e},"*")):i.error("Domain '"+n+"' not trusted. Events won't be tracked in iframe")},!1)},s.prototype.processHost=function(t){var e,o=this,i=new Map;this.context.uid&&(e=this.context.document.querySelectorAll(t.selector||"iframe"),this.context.window.addEventListener("message",function(t){var e,n=null===(e=t.data)||void 0===e?void 0:e.rid;n&&(o.debug1("Received message (host): ",t.data),i.delete(n))}),e.forEach(function(t){t instanceof HTMLIFrameElement&&i.set(Utils.newid(!1),t)}),this.updateFrames(i))},s.prototype.updateFrames=function(t){var e,n,o=this;if(0!=t.size){try{for(var i=__values(t),r=i.next();!r.done;r=i.next()){var s,a=__read(r.value,2),c=a[0],u=a[1];u.contentWindow&&(s={rid:c,uid:this.context.uid},this.debug1("Sending message: ",s),u.contentWindow.postMessage(s,"*"))}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}setTimeout(function(){return o.updateFrames(t)},500)}},s.isStandalone=function(t){return!t.binding||"auto"==t.binding.mode&&!this.isInFrame()},s.isInFrame=function(){return window.top!==window.self},s.isHost=function(t){var e,n;return"host"==(null===(e=t.binding)||void 0===e?void 0:e.mode)||"auto"==(null===(n=t.binding)||void 0===n?void 0:n.mode)&&!this.isInFrame()||!1},s.isGuest=function(t){var e,n;return"guest"==(null===(e=t.binding)||void 0===e?void 0:e.mode)||"auto"==(null===(n=t.binding)||void 0===n?void 0:n.mode)&&this.isInFrame()||!1},s.prototype.processCookie=function(t){var e=this.storage.read(this.context.cookieConfig.cookieName);e?this.debug("Found uid: "+e):(e=this.storage.read("id_op"))?(this.debug("Migrating uid from 'id_op': "+e),this.storage.create(e)):t.clientSideCookie?(e=Utils.newid(),this.debug("Creating uid: "+e),this.storage.create(e)):this.debug("Server side cookie"),this.context.uid=e},s}(ICommand),Queue=function(){function t(t,e){this.wnd=t,this.commands=e,this.queue=this.wnd.sw.q||[]}return t.prototype.execute=function(){for(var t=function(t,e,n){n?n.execute(e):console.error("SalesWings configuration error. `"+t+"` command is not found")},e=0;e<arguments.length;){var n=arguments[e],o=this.commands.get(n),i=arguments[e+1];i&&"string"!=typeof i?(t(n,i,o),e+=2):(t(n,{},o),e++)}},t.prototype.run=function(){var e=this;this.wnd.sw=this.execute.bind(this),this.queue.forEach(function(t){e.wnd.sw.apply(e,t)})},t}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},SendValuesCommand=function(n){function t(t){var e=n.call(this,t)||this;return e.context=t,e}return __extends(t,n),t.prototype.execute=function(e){var n=this;e.values?this.send(function(t){return{key:"values",event:{p:t.pid,u:n.context.uid,t:n.getTime(),url:e.url||n.url(),values:e.values}}}):this.error("'values' parameter is required")},t}(ICommand),SendFormSubmitCommand=function(n){function t(t){var e=n.call(this,t)||this;return e.context=t,e}return __extends(t,n),t.prototype.execute=function(e){var n=this;e.email&&""!==e.email?this.send(function(t){return{key:"form-submit",event:{p:t.pid,u:n.context.uid,t:n.getTime(),url:e.url||n.url(),ea:e.email,values:e.values}}}):this.error("'email' parameter is required")},t}(ICommand),SendCustomEventCommand=function(n){function t(t){var e=n.call(this,t)||this;return e.context=t,e}return __extends(t,n),t.prototype.execute=function(e){var n=this;e.kind&&""!==e.kind?this.send(function(t){return{key:"custom-event",event:{p:t.pid,u:n.context.uid,t:n.getTime(),url:e.url||n.url(),kind:e.kind,data:e.data,values:e.values}}}):this.error("'kind' parameter is required")},t}(ICommand),SendCommand=function(n){function t(t){var e=n.call(this,t)||this;return e.context=t,e}return __extends(t,n),t.prototype.execute=function(e){var n,o=this;e.event?e.data?(n=e.data,"form-submit"==e.event&&"object"==typeof n&&n.hasOwnProperty("email")&&(n.ea=n.email,delete n.email),this.send(function(t){return{key:e.event,event:__assign({p:t.pid,u:o.context.uid,t:o.getTime(),url:e.url||o.url()},n)}},e.cb)):this.error("'data' parameter is required"):this.error("'event' parameter is required")},t}(ICommand),Utils=function(){function o(){}return o.stringifyObject=function(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")},o.newid=function(t){var e;void 0===t&&(t=!0);try{var n=new Uint32Array(1);window.crypto.getRandomValues(n),e=n[0]&this.max}catch(t){e=Math.round(this.max*Math.random())}return t?[o.toBase62((new Date).getTime()),o.toBase62(e)].join("-"):o.toBase62(e)},o.toBase62=function(t){var e,n;for(t=t!==+t||t%1?-1:t,n="";0<=t;t=Math.floor(t/62)||-1)n=String.fromCharCode((9<(e=t%62)?35<e?29:87:48)+e)+n;return n},o.itcold=function(t,e,n){var o=t.getElementsByTagName(e);this.itcol(o,n)},o.itcol=function(t,e){for(var n=0;n<t.length;n++)e(t[n])},o.max=2147483647,o}(),XURL=function(){function t(t,e,n,o,i,r){this.protocol=t,this.host=e,this.hash=n,this.query=o,this.pathname=i,this.href=r}return t.prototype.addParameter=function(t,e){this.query[t]=e},t.prototype.render=function(){var t=this.hash?"#"+this.hash:"",e=Utils.stringifyObject(this.query);return this.protocol+"//"+this.host+this.pathname+e+t},t}(),UrlParser=function(){function t(t){this.doc=t,this.urlParser=void 0,this.doc=t}return t.prototype.checkIfCreated=function(){if(!this.urlParser)try{this.urlParser=this.doc.createElement("a")}catch(t){}},t.prototype.parse=function(t){if(this.checkIfCreated(),this.urlParser){this.urlParser.href=t;var o={};return this.urlParser.search.replace(/^\?/,"").replace(/([^=&]+)=([^&]*)/g,function(t,e,n){return o[decodeURIComponent(e)]=decodeURIComponent(n),""}),new XURL(this.urlParser.protocol,this.urlParser.host,this.urlParser.hash,o||void 0,this.urlParser.pathname||"/",this.urlParser.href)}},t}(),TrackFormsCommand=function(n){function t(t){var e=n.call(this,t)||this;return e.context=t,e.regexp=/^[a-zA-Z0-9.!#$%&*+=?^_~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$/,e.trackEmails=!0,e}return __extends(t,n),t.prototype.execute=function(t){var e=this;t.delay?setTimeout(function(){return e.doExecute(t)},t.delay):this.doExecute(t)},t.prototype.doExecute=function(t){var e,n=this,o=this.context.document;"legacy"===t.mode?(e=o.getElementsByTagName("input"),o.addEventListener("click",function(){return Utils.itcol(e,n.trackEmail.bind(n))}),o.addEventListener("keydown",function(t){"Tab"===t.key&&Utils.itcol(e,n.trackEmail.bind(n))})):"blur"===t.mode?Utils.itcold(o,"input",function(t){t.addEventListener("blur",function(t){t.target&&t.target instanceof Element&&n.trackEmail.bind(n)(t.target)})}):"submit"===t.mode&&Utils.itcold(o,"form",function(t){t.addEventListener("submit",function(t){t.target&&t.target instanceof Element&&Utils.itcold(o,"input",n.trackEmail.bind(n))})})},t.prototype.trackEmail=function(t){var e,n=this;this.trackEmails&&t instanceof HTMLInputElement&&!t.hidden&&"hidden"!==t.type&&((e=t.value||"")!=t.placeholder&&this.regexp.test(e)&&this.send(function(t){return n.trackEmails=!1,{key:"form-submit",event:{p:t.pid,u:n.context.uid,t:n.getTime(),url:n.url(),ea:e}}}))},t}(ICommand),TrackPageviewCommand=function(n){function t(t){var e=n.call(this,t)||this;return e.context=t,e}return __extends(t,n),t.prototype.process=function(){var e=this;this.send(function(t){return{key:"pageview",event:{p:t.pid,u:e.context.uid,t:e.getTime(),url:e.url(),r:e.context.document.referrer||void 0}}})},t.prototype.execute=function(t){var e,n;void 0!==t.trackHashChange&&!t.trackHashChange||this.context.window.addEventListener("hashchange",this.process.bind(this),!1),void 0!==t.trackLocationChange&&!t.trackLocationChange||(e=this.process.bind(this),n=window.location.pathname,setInterval(function(){n!=window.location.pathname&&(e(),n=window.location.pathname)},500)),this.process()},t}(ICommand),ITransport=function(){function t(t){this.context=t,this.context=t}return t.prototype.debug=function(t){this.context.logging.debug(t)},t.prototype.error=function(t){this.context.logging.error(t)},t}(),XhrTransport=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onreadystatechange=function(t,e){4==t.readyState&&(200!=t.status&&this.error("Tracking query failed ("+(t.status?t.statusText:"unknown")+")"),e&&e())},t}(ITransport),PostTransport=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.send=function(t,e,n,o){var i=this,r=new XMLHttpRequest;r.open("POST",t.apiUrl,!0),r.withCredentials=!0,r.setRequestHeader("content-type","application/json"),n.e=e,r.onreadystatechange=function(){i.onreadystatechange(r,o)},r.ontimeout=r.onerror=r.onerror=function(){o&&o()},r.send(JSON.stringify(n))},t}(XhrTransport),BeaconTransport=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.send=function(t,e,n,o){n.e=e;var i=JSON.stringify(n),r=new Blob([i],{type:"application/json; charset=UTF-8"});navigator.sendBeacon(t.apiUrl,r)},t}(XhrTransport),GetTransport=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.send=function(t,e,n,o){var i=this,r=Utils.stringifyObject(n),s=new XMLHttpRequest,a=this.context.apiUrl;s.open("GET",a+r,!0),s.withCredentials=!1,s.setRequestHeader("content-type","text/html"),s.onreadystatechange=function(){i.onreadystatechange(s,o)},s.ontimeout=s.onerror=s.onerror=function(){o&&o()},s.send(null)},t}(XhrTransport),LoggingTransport=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.send=function(t,e,n,o){this.debug(e),this.debug(n),o&&o()},t}(ITransport);!function(n,t){n.swe=n.swe||function(t,e){"function"==typeof n.sw?n.sw("customEvent",{kind:t,data:e}):console.error("SalesWings hasn't been initialised yet")};var e={cookieDomain:null,cookieExpires:31536e6,cookieName:"sw",cookiePath:"/"},o={document:t,window:n,logging:new SilentLogging,apiUrl:"https://to.go.saleswingsapp.com",cookieConfig:e,uid:void 0,storage:new CookieStorage(e,n,t),accounts:[]},i=new Map;i.set("init",new InitCommand(o)),i.set("trackForms",new TrackFormsCommand(o)),i.set("track-forms",new TrackFormsCommand(o)),i.set("trackPageviews",new TrackPageviewCommand(o)),i.set("customEvent",new CustomEventCommand(o)),i.set("custom-event",new CustomEventCommand(o)),i.set("sendFormSubmit",new SendFormSubmitCommand(o)),i.set("send-form-submit",new SendFormSubmitCommand(o)),i.set("sendCustomEvent",new SendCustomEventCommand(o)),i.set("send-custom-event",new SendCustomEventCommand(o)),i.set("sendValues",new SendValuesCommand(o)),i.set("send-values",new SendValuesCommand(o)),i.set("send",new SendCommand(o)),new Queue(n,i).run()}(window,window.document);
